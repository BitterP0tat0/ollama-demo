"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Controller = Controller;
const reflect_metadata_utils_1 = require("@inversifyjs/reflect-metadata-utils");
const inversify_1 = require("inversify");
const controllerMetadataReflectKey_1 = require("../../reflectMetadata/data/controllerMetadataReflectKey");
const buildNormalizedPath_1 = require("../calculations/buildNormalizedPath");
// eslint-disable-next-line @typescript-eslint/naming-convention
function Controller(pathOrOptions) {
    return (target) => {
        const controllerMetadata = {
            path: '/',
            priority: 0,
            serviceIdentifier: target,
            target,
        };
        let scope = undefined;
        if (pathOrOptions !== undefined) {
            if (typeof pathOrOptions === 'string') {
                controllerMetadata.path = (0, buildNormalizedPath_1.buildNormalizedPath)(pathOrOptions);
            }
            else {
                controllerMetadata.path = (0, buildNormalizedPath_1.buildNormalizedPath)(pathOrOptions.path ?? '/');
                if (pathOrOptions.priority !== undefined) {
                    controllerMetadata.priority = pathOrOptions.priority;
                }
                if (pathOrOptions.serviceIdentifier !== undefined) {
                    controllerMetadata.serviceIdentifier =
                        pathOrOptions.serviceIdentifier;
                }
                scope = pathOrOptions.scope;
            }
        }
        (0, inversify_1.injectable)(scope)(target);
        (0, reflect_metadata_utils_1.updateOwnReflectMetadata)(Reflect, controllerMetadataReflectKey_1.controllerMetadataReflectKey, reflect_metadata_utils_1.buildEmptyArrayMetadata, (0, reflect_metadata_utils_1.buildArrayMetadataWithElement)(controllerMetadata));
    };
}
//# sourceMappingURL=Controller.js.map