"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.WinstonLoggerAdapter = void 0;
const winston_1 = require("winston");
const LoggerAdapter_1 = require("../../../modules/LoggerAdapter");
class WinstonLoggerAdapter extends LoggerAdapter_1.LoggerAdapter {
    #logger;
    constructor(logger, context, loggerOptions) {
        super(context, loggerOptions);
        this.#logger = logger;
        this.#formatLogger();
    }
    printLog(logType, message, context) {
        this.#logger.log(logType, message, context);
    }
    #buildOptionsFormatList() {
        const formatList = [];
        if (this._loggerOptions.timestamp) {
            formatList.push(winston_1.format.timestamp({
                format: 'YYYY-MM-DD hh:mm:ss.SSS A',
            }));
        }
        if (this._loggerOptions.json) {
            formatList.push(winston_1.format.json(), winston_1.format.prettyPrint());
        }
        else {
            formatList.push(winston_1.format.colorize({ all: true }), winston_1.format.printf((info) => this.#stringifyInfo(info)));
        }
        return formatList;
    }
    #formatLogger() {
        this.#logger.format = winston_1.format.combine(this.#logger.format, ...this.#buildOptionsFormatList());
    }
    #stringifyInfo(info) {
        const prefix = info['context'] ?? 'InversifyJS';
        return `[${prefix}] - ${String(process.pid)}${this._loggerOptions.timestamp ? ` ${info['timestamp']}` : ''} ${info.level}: ${info.message}`;
    }
}
exports.WinstonLoggerAdapter = WinstonLoggerAdapter;
//# sourceMappingURL=WinstonLoggerAdapter.js.map